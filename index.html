<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Merry Christmas Rose!</title>
  <style>
    :root{
      --bg1: #0b1020;
      --bg2: #071126;
      --accent: #ffdd57;
      --green: #1e8a4a;
      --red: #d32f2f;
      --soft: rgba(255,255,255,0.06);
      --glass: rgba(255,255,255,0.04);
      --font-sans: 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    html,body{height:100%;margin:0;font-family:var(--font-sans);background:linear-gradient(180deg,var(--bg1),var(--bg2));color:white;}
    .stage{
      min-height:100vh;display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden;padding:4vmin;
      background-image: radial-gradient(circle at 10% 10%, rgba(255,255,255,0.02), transparent 10%),
                        radial-gradient(circle at 90% 80%, rgba(255,255,255,0.02), transparent 12%);
    }

    canvas.snow{
      position:absolute;inset:0;pointer-events:none;z-index:0;opacity:0.95;
    }

    .card{
      position:relative;z-index:2;background:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      border-radius:18px;padding:clamp(24px,6vmin,48px);box-shadow:0 10px 40px rgba(0,0,0,0.6);backdrop-filter: blur(6px);
      display:flex;flex-direction:column;align-items:center;gap:1.5rem;max-width:1000px;width:100%;
    }

    .headline{
      font-size:clamp(28px,6vmin,72px);font-weight:800;letter-spacing:0.02em;display:flex;flex-wrap:wrap;justify-content:center;gap:0.6rem;
    }

    .headline .word{display:inline-flex;gap:0.25rem}
    .letter{
      display:inline-block;transform-origin:50% 80%;padding:0.1em 0.08em;border-radius:6px;position:relative;user-select:none;
      font-variant-ligatures: none;
    }

    .letter .bulb{
      display:inline-block;padding:0.08em 0.12em;border-radius:6px;min-width:0.65em;text-align:center;font-weight:900;
      transition:transform 420ms cubic-bezier(.2,.9,.3,1), box-shadow 300ms ease, filter 300ms ease;
      box-shadow:0 2px 12px rgba(0,0,0,0.5);
      color:var(--bg2);
    }

    .letter[data-color="red"] .bulb{background:linear-gradient(180deg,var(--red),#ff6b6b);color:#fff}
    .letter[data-color="green"] .bulb{background:linear-gradient(180deg,#4bb17b,var(--green));color:#05220f}
    .letter[data-color="gold"] .bulb{background:linear-gradient(180deg,#ffee99,var(--accent));color:#4a2f00}
    .letter[data-color="ice"] .bulb{background:linear-gradient(180deg,#e6f7ff,#bfe9ff);color:#00293f}

    @keyframes floaty{0%{transform:translateY(0) rotate(0deg)}50%{transform:translateY(-8px) rotate(-2deg)}100%{transform:translateY(0) rotate(0deg)}}
    .letter{animation:floaty 3200ms ease-in-out infinite;}

    @keyframes twinkle{
      0%,100%{filter:brightness(1);box-shadow:0 6px 18px rgba(0,0,0,0.6)}
      50%{filter:brightness(1.35);box-shadow:0 10px 30px rgba(0,0,0,0.7)}
    }

    .letter::after{
      content:"";position:absolute;right:-6%;top:-30%;width:8px;height:8px;border-radius:50%;opacity:0;transform:scale(0);
      box-shadow:0 0 10px 4px rgba(255,255,255,0.6);
      transition:opacity .25s ease, transform .3s ease;
    }

    .letter.holly::before{
      content:"üéÑ";position:absolute;left:-0.55em;top:-0.5em;font-size:0.7em;transform:rotate(-12deg);
    }

    .letter.santa::before{
      content:"üéÖ";position:absolute;left:-0.45em;top:-0.9em;font-size:0.9em;transform:rotate(-8deg);
    }

    .letter:active .bulb{transform:scale(1.08) translateY(-3px)}
    .letter:hover .bulb{transform:translateY(-4px) scale(1.03)}

    .controls{display:flex;gap:0.5rem;align-items:center}
    button.btn{background:var(--glass);border:1px solid rgba(255,255,255,0.06);padding:0.5rem 0.9rem;border-radius:999px;color:inherit;cursor:pointer}

    footer{font-size:.9rem;color:rgba(255,255,255,0.7)}

    @media (max-width:520px){
      .headline{gap:0.3rem}
    }
  </style>
</head>
<body>
  <div class="stage">
    <canvas class="snow"></canvas>

    <div class="card" role="main" aria-label="Merry Christmas Rose!">
      <div class="headline" id="headline" aria-hidden="false"></div>

      <div class="controls" aria-hidden="true">
        <button class="btn" id="toggleSnow">Alternar Neve ‚ùÑÔ∏è</button>
        <button class="btn" id="sparkle">Estrelas ‚ú®</button>
        <button class="btn" id="randomize">Aleatorizar Cores</button>
      </div>

      <footer>Feliz Natal Rose, eu sei que isto n√£o √© nada comparado com um presente f√≠sico, mas foi feito com cora√ß√£o ‚ù§Ô∏è. Clique nas letras para brincar!</footer>
    </div>
  </div>

  <script>
    const message = 'Merry Christmas Rose!';
    const container = document.getElementById('headline');

    const colors = ['red','green','gold','ice'];

    function buildMessage(txt){
      container.innerHTML = '';
      const words = txt.split(' ');
      words.forEach((w, wi)=>{
        const wordEl = document.createElement('div');
        wordEl.className = 'word';
        Array.from(w).forEach((ch, i)=>{
          const span = document.createElement('span');
          span.className = 'letter';
          span.dataset.color = colors[(i + wi*3) % colors.length];

          span.style.animationDelay = (Math.random()*600) + 'ms';
          span.style.animationDuration = (2800 + Math.random()*1400) + 'ms';

          const bulb = document.createElement('span');
          bulb.className = 'bulb';
          bulb.textContent = ch;

          span.appendChild(bulb);

          if(wi===0 && i===0) span.classList.add('santa');
          if(ch.toLowerCase() === 'n' || ch.toLowerCase() === 'c') span.classList.add('holly');

          setInterval(()=>{
            bulb.style.animation = 'twinkle '+(800 + Math.random()*900)+'ms ease-in-out 1';
            setTimeout(()=> bulb.style.animation = '', 1800);
          }, 1500 + Math.random()*3000);

          span.addEventListener('click',()=>{
            spawnSparkleAt(span.getBoundingClientRect());
            bulb.style.transform = 'translateY(-14px) scale(1.12)';
            setTimeout(()=> bulb.style.transform = '', 380);
          });

          wordEl.appendChild(span);
        });
        container.appendChild(wordEl);
      });
    }

    buildMessage(message);

    const canvas = document.querySelector('canvas.snow');
    const ctx = canvas.getContext('2d');
    let width, height, flakes = [];
    function resize(){
      width = canvas.width = innerWidth;
      height = canvas.height = innerHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    function createFlakes(n=120){
      flakes = [];
      for(let i=0;i<n;i++) flakes.push({x:Math.random()*width,y:Math.random()*height, r:1+Math.random()*3, d:Math.random()*Math.PI*2, s:0.3+Math.random()*1.2});
    }
    createFlakes(120);

    let snowOn = true;
    document.getElementById('toggleSnow').addEventListener('click', ()=>{ snowOn = !snowOn; canvas.style.display = snowOn? 'block':'none'; });

    function draw(){
      ctx.clearRect(0,0,width,height);
      if(!snowOn) return;
      ctx.fillStyle = 'rgba(255,255,255,0.85)';
      ctx.beginPath();
      for(const f of flakes){
        ctx.moveTo(f.x,f.y);
        ctx.arc(f.x,f.y,f.r,0,Math.PI*2);
      }
      ctx.fill();

      for(const f of flakes){
        f.y += f.s;
        f.x += Math.sin(f.d)*0.6;
        f.d += 0.005;
        if(f.y>height+5){ f.y = -10; f.x = Math.random()*width; }
      }
    }
    function loop(){ draw(); requestAnimationFrame(loop); }
    loop();

    function spawnSparkleAt(rect){
      const sparkle = document.createElement('div');
      sparkle.style.position = 'fixed';
      sparkle.style.left = (rect.left + rect.width/2) + 'px';
      sparkle.style.top = (rect.top + rect.height/2) + 'px';
      sparkle.style.width = '10px';
      sparkle.style.height = '10px';
      sparkle.style.borderRadius = '50%';
      sparkle.style.pointerEvents = 'none';
      sparkle.style.zIndex = 9999;
      sparkle.style.boxShadow = '0 0 12px 6px rgba(255,255,255,0.9)';
      document.body.appendChild(sparkle);
      const dx = (Math.random()-0.5)*160;
      const dy = -90 - Math.random()*60;
      sparkle.animate([
        {transform:'translate(0,0) scale(0.6)', opacity:1},
        {transform:`translate(${dx}px, ${dy}px) scale(1.4)`, opacity:0}
      ], {duration:800 + Math.random()*500, easing:'cubic-bezier(.2,.9,.3,1)'});
      setTimeout(()=> sparkle.remove(), 1400);
    }

    document.getElementById('sparkle').addEventListener('click', ()=>{
      const letters = Array.from(document.querySelectorAll('.letter'));
      for(let i=0;i<24;i++){
        const l = letters[Math.floor(Math.random()*letters.length)];
        spawnSparkleAt(l.getBoundingClientRect());
      }
    });

    document.getElementById('randomize').addEventListener('click', ()=>{
      document.querySelectorAll('.letter').forEach(el=>{
        el.dataset.color = colors[Math.floor(Math.random()*colors.length)];
      });
    });

    setInterval(()=>{
      const letters = document.querySelectorAll('.letter');
      const el = letters[Math.floor(Math.random()*letters.length)];
      if(!el) return;
      el.querySelector('.bulb').style.filter = 'brightness(1.45)';
      el.style.transform = 'translateY(-8px) rotate(-2deg)';
      el.querySelector('.bulb').style.boxShadow = '0 12px 30px rgba(0,0,0,0.6)';
      setTimeout(()=>{
        el.querySelector('.bulb').style.filter='';
        el.style.transform='';
        el.querySelector('.bulb').style.boxShadow='';
      }, 600 + Math.random()*900);
    }, 900);

    setTimeout(()=> document.getElementById('sparkle').click(), 800);

    window.addEventListener('keydown', (e)=>{
      if(e.key === ' ' || e.key === 'Enter'){
        document.getElementById('sparkle').click();
        e.preventDefault();
      }
    });

    window.__merry = {
      toggleSnow(){ snowOn = !snowOn; canvas.style.display = snowOn? 'block':'none'; },
      setMessage(m){ buildMessage(m); }
    };
  </script>
</body>
</html>
